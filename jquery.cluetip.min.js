/*!
 * jQuery clueTip plugin v1.2.4
 *
 * Date: Fri Dec 09 23:26:18 2011 EST
 * Requires: jQuery v1.3+
 *
 * Copyright 2011, Karl Swedberg
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 *
 * Examples can be found at http://plugins.learningjquery.com/cluetip/demo/
 *
*/
(function(c){c.cluetip={version:"1.2.4",template:'<div><div class="cluetip-outer"><h3 class="cluetip-title ui-widget-header ui-cluetip-header"></h3><div class="cluetip-inner ui-widget-content ui-cluetip-content"></div></div><div class="cluetip-extra"></div><div class="cluetip-arrows ui-state-default"></div></div>',setup:{insertionType:"appendTo",insertionElement:"body"},defaults:{multiple:false,width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,local:false,localPrefix:null,
localIdSuffix:null,hideLocal:true,attribute:"rel",titleAttribute:"title",splitTitle:"",escapeTitle:false,showTitle:true,cluetipClass:"default",hoverClass:"",waitImage:true,cursor:"help",arrows:false,dropShadow:true,dropShadowSteps:6,sticky:false,mouseOutClose:false,activation:"hover",clickThrough:true,tracking:false,delayedClose:0,closePosition:"top",closeText:"Close",truncate:0,fx:{open:"show",openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(){return true},onShow:function(){},
onHide:function(){},ajaxCache:true,ajaxProcess:function(j){return j=j.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,"").replace(/<(link|meta)[^>]+>/g,"")},ajaxSettings:{dataType:"html"},debug:false}};var z,fa=0,N=0;c.fn.attrProp=c.fn.prop||c.fn.attr;c.fn.cluetip=function(j,t){function O(P,q,g){g="";q=q.dropShadow&&q.dropShadowSteps?+q.dropShadowSteps:0;if(c.support.boxShadow){if(q)g="1px 1px "+q+"px rgba(0,0,0,0.5)";P.css(c.support.boxShadow,g);return false}g=P.find(".cluetip-drop-shadow");
if(q==g.length)return g;g.remove();g=[];for(var d=0;d<q;)g[d++]='<div style="top:'+d+"px;left:"+d+'px;"></div>';return g=c(g.join("")).css({position:"absolute",backgroundColor:"#000",zIndex:U-1,opacity:0.1}).addClass("cluetip-drop-shadow").prependTo(P)}var e,h,p,A,r,Q;if(typeof j=="object"){t=j;j=null}if(j=="destroy"){var R=this.data("cluetip");if(R){c(R.selector).remove();c.removeData(this,"title");c.removeData(this,"cluetip");c(document).unbind(".cluetip");return this.unbind(".cluetip")}}t=c.extend(true,
{},c.cluetip.defaults,t||{});fa++;R=c.cluetip.backCompat||!t.multiple?"cluetip":"cluetip-"+fa;var ba="#"+R,u=c.cluetip.backCompat?"#":".",V=c.cluetip.setup.insertionType,ka=c.cluetip.setup.insertionElement||"body";V=/appendTo|prependTo|insertBefore|insertAfter/.test(V)?V:"appendTo";e=c(ba);if(!e.length){e=c(c.cluetip.template)[V](ka).attr("id",R).css({position:"absolute",display:"none"});var U=+t.cluezIndex;p=e.find(u+"cluetip-outer").css({position:"relative",zIndex:U});h=e.find(u+"cluetip-inner");
A=e.find(u+"cluetip-title")}z=c("#cluetip-waitimage");z.length||(z=c("<div></div>").attr("id","cluetip-waitimage").css({position:"absolute"}));z.insertBefore(e).hide();var la=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0);this.each(function(P){function q(){return false}var g=this,d=c(this),a=c.extend(true,{},t,c.metadata?d.metadata():c.meta?d.data():d.data("cluetip")||{}),E=false,I=false,ga=0,m=a[a.attribute]||d.attrProp(a.attribute)||d.attr(a.attribute),S=a.cluetipClass;
U=+a.cluezIndex;d.data("cluetip",{title:g.title,zIndex:U,selector:ba});if(!m&&!a.splitTitle&&!j)return true;if(a.local&&a.localPrefix)m=a.localPrefix+m;a.local&&a.hideLocal&&m&&c(m+":first").hide();var s=parseInt(a.topOffset,10),B=parseInt(a.leftOffset,10),C,ca,W=isNaN(parseInt(a.height,10))?"auto":/\D/g.test(a.height)?a.height:a.height+"px",X,v,w,J,Y,da=parseInt(a.width,10)||275,n=da+la+a.dropShadowSteps,F=this.offsetWidth,x,k,o,K,G,y=a.attribute!="title"?d.attrProp(a.titleAttribute)||"":"";if(a.splitTitle){G=
y.split(a.splitTitle);y=a.showTitle||G[0]===""?G.shift():""}if(a.escapeTitle)y=y.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;");var $=function(b){var f;if(a.onActivate(d)===false)return false;I=true;e=c(ba).css({position:"absolute"});p=e.find(u+"cluetip-outer");h=e.find(u+"cluetip-inner");A=e.find(u+"cluetip-title");r=e.find(u+"cluetip-arrows");e.removeClass().css({width:da});m==d.attr("href")&&d.css("cursor",a.cursor);a.hoverClass&&d.addClass(a.hoverClass);v=d.offset().top;x=d.offset().left;
F=d.innerWidth();if(b.type==focus){o=x+F/2+B;e.css({left:k});J=v+s}else{o=b.pageX;J=b.pageY}if(g.tagName.toLowerCase()!="area"){X=c(document).scrollTop();K=c(window).width()}if(a.positionBy=="fixed"){k=F+x+B;e.css({left:k})}else{k=F>x&&x>n||x+F+n+B>K?x-n-B:F+x+B;if(g.tagName.toLowerCase()=="area"||a.positionBy=="mouse"||F+n>K)if(o+20+n>K){e.addClass("cluetip-"+S);k=o-n-B>=0?o-n-B-parseInt(e.css("marginLeft"),10)+parseInt(h.css("marginRight"),10):o-n/2}else k=o+B;f=k<0?b.pageY+s:b.pageY;if(k<0||a.positionBy==
"bottomTop")k=o+n/2>K?K/2-n/2:Math.max(o-n/2,0)}r.css({zIndex:d.data("cluetip").zIndex+1});e.css({left:k,zIndex:d.data("cluetip").zIndex});ca=c(window).height();if(j){if(typeof j=="function")j=j.call(g);h.html(j);L(f)}else if(G){b=G.length;h.html(b?G[0]:"");if(b>1)for(var i=1;i<b;i++)h.append('<div class="split-body">'+G[i]+"</div>");L(f)}else if(!a.local&&m.indexOf("#")!==0)if(/\.(jpe?g|tiff?|gif|png)(?:\?.*)?$/i.test(m)){h.html('<img src="'+m+'" alt="'+y+'" />');L(f)}else{var l=a.ajaxSettings.beforeSend,
M=a.ajaxSettings.error,ha=a.ajaxSettings.success,ia=a.ajaxSettings.complete;b=c.extend(true,{},a.ajaxSettings,{cache:a.ajaxCache,url:m,beforeSend:function(D,H){l&&l.call(g,D,e,h,H);p.children().empty();a.waitImage&&z.css({top:J+20,left:o+20,zIndex:d.data("cluetip").zIndex-1}).show()},error:function(D,H){if(I)M?M.call(g,D,H,e,h):h.html("<i>sorry, the contents could not be loaded</i>")},success:function(D,H){E=a.ajaxProcess.call(g,D);if(typeof E=="object"&&E!==null){y=E.title;E=E.content}if(I){ha&&
ha.call(g,D,H,e,h);h.html(E)}},complete:function(D,H){ia&&ia.call(g,D,H,e,h);var Z=h[0].getElementsByTagName("img");N=Z.length;for(var ea=0,ma=Z.length;ea<ma;ea++)Z[ea].complete&&N--;if(N&&!c.browser.opera)c(Z).bind("load error",function(){N--;if(N<1){z.hide();I&&L(f)}});else{z.hide();I&&L(f)}}});c.ajax(b)}else if(a.local){b=c(m+(/^#\S+$/.test(m)?"":":eq("+P+")")).clone(true).show();a.localIdSuffix&&b.attr("id",b[0].id+a.localIdSuffix);h.html(b);L(f)}},L=function(b){var f,i;f=y||a.showTitle&&"&nbsp;";
var l="";i="";e.addClass("cluetip-"+S);if(a.truncate){var M=h.text().slice(0,a.truncate)+"...";h.html(M)}f?A.show().html(f):A.hide();if(a.sticky){f=c('<div class="cluetip-close"><a href="#">'+a.closeText+"</a></div>");a.closePosition=="bottom"?f.appendTo(h):a.closePosition=="title"?f.prependTo(A):f.prependTo(h);f.bind("click.cluetip",function(){T();return false});a.mouseOutClose?e.bind("mouseleave.cluetip",function(){T()}):e.unbind("mouseleave.cluetip")}p.css({zIndex:d.data("cluetip").zIndex,overflow:W==
"auto"?"visible":"auto",height:W});C=W=="auto"?Math.max(e.outerHeight(),e.height()):parseInt(W,10);w=v;Y=X+ca;if(a.positionBy=="fixed")w=v-a.dropShadowSteps+s;else if(k<o&&Math.max(k,0)+n>o||a.positionBy=="bottomTop")if(v+C+s>Y&&J-X>C+s){w=J-C-s;i="top"}else{w=J+s;i="bottom"}else w=v+C+s>Y?C>=ca?X:Y-C-s:d.css("display")=="block"||g.tagName.toLowerCase()=="area"||a.positionBy=="mouse"?b-s:v-a.dropShadowSteps;if(i==="")i=k<x?"left":"right";f=" clue-"+i+"-"+S+" cluetip-"+S;if(S=="rounded")f+=" ui-corner-all";
e.css({top:w+"px"}).attrProp({className:"cluetip ui-widget ui-widget-content ui-cluetip"+f});if(a.arrows){if(/(left|right)/.test(i)){i=e.height()-r.height();l=k>=0&&b>0?v-w-a.dropShadowSteps:0;l=i>l?l:i;l+="px"}r.css({top:l}).show()}else r.hide();(Q=O(e,a))&&Q.length&&Q.hide().css({height:C,width:da,zIndex:d.data("cluetip").zIndex-1}).show();e.hide()[a.fx.open](a.fx.openSpeed||0);c.fn.bgiframe&&e.bgiframe();if(a.delayedClose>0)ga=setTimeout(T,a.delayedClose);a.onShow.call(g,e,h)},aa=function(){I=
false;z.hide();if(!a.sticky||/click|toggle/.test(a.activation)){T();clearTimeout(ga)}a.hoverClass&&d.removeClass(a.hoverClass)},T=function(b){b=b&&b.data("cluetip")?b:d;var f=b.data("cluetip")&&b.data("cluetip").selector,i=c(f||"div.cluetip"),l=i.find(u+"cluetip-inner"),M=i.find(u+"cluetip-arrows");i.hide().removeClass();a.onHide.call(b[0],i,l);if(f){b.removeClass("cluetip-clicked");b.css("cursor","")}f&&y&&b.attrProp(a.titleAttribute,y);a.arrows&&M.css({top:""})};c(document).unbind("hideCluetip.cluetip").bind("hideCluetip.cluetip",
function(b){T(c(b.target))});if(/click|toggle/.test(a.activation))d.bind("click.cluetip",function(b){if(e.is(":hidden")||!d.is(".cluetip-clicked")){$(b);c(".cluetip-clicked").removeClass("cluetip-clicked");d.addClass("cluetip-clicked")}else aa(b);return false});else if(a.activation=="focus"){d.bind("focus.cluetip",function(b){d.attrProp("title","");$(b)});d.bind("blur.cluetip",function(b){d.attrProp("title",d.data("cluetip").title);aa(b)})}else{d[a.clickThrough?"unbind":"bind"]("click.cluetip",q);
var ja=function(b){if(a.tracking){var f=k-b.pageX,i=w?w-b.pageY:v-b.pageY;d.bind("mousemove.cluetip",function(l){e.css({left:l.pageX+f,top:l.pageY+i})})}};c.fn.hoverIntent&&a.hoverIntent?d.hoverIntent({sensitivity:a.hoverIntent.sensitivity,interval:a.hoverIntent.interval,over:function(b){$(b);ja(b)},timeout:a.hoverIntent.timeout,out:function(b){aa(b);d.unbind("mousemove.cluetip")}}):d.bind("mouseenter.cluetip",function(b){$(b);ja(b)}).bind("mouseleave.cluetip",function(b){aa(b);d.unbind("mousemove.cluetip")});
d.bind("mouseover.cluetip",function(){d.attrProp("title","")}).bind("mouseleave.cluetip",function(){d.attrProp("title",d.data("cluetip").title)})}});return this};(function(){c.support=c.support||{};for(var j=document.createElement("div").style,t=["boxShadow"],O=["moz","Moz","webkit","o"],e=0,h=t.length;e<h;e++){var p=t[e],A=p.charAt(0).toUpperCase()+p.slice(1);if(typeof j[p]!=="undefined")c.support[p]=p;else for(var r=0,Q=O.length;r<Q;r++)if(typeof j[O[r]+A]!=="undefined"){c.support[p]=O[r]+A;break}}})();
c.fn.cluetip.defaults=c.cluetip.defaults})(jQuery);
